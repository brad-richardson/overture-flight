const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/three.tsl-PtvVTNdH.js","assets/three.webgpu-D9eBbvPW.js","assets/index-4Z0U--YI.js"])))=>i.map(i=>d[i]);
import{V as D,D as M,bQ as P,bd as S,H as g,L as U,al as _,fY as F}from"./index-4Z0U--YI.js";let w=null,h=null;async function V(){return w||(w=await F(()=>import("./three.tsl-PtvVTNdH.js"),__vite__mapDeps([0,1,2]))),w}async function z(){return h||(h=await F(()=>import("./three.webgpu-D9eBbvPW.js"),__vite__mapDeps([1,2]))),h}async function R(n){const e=await V(),{MeshStandardNodeMaterial:c}=await z(),o=e.texture(n.elevationTexture),r=e.uniform(n.verticalExaggeration),s=e.uniform(new D(n.tileCenter.x,n.tileCenter.z)),u=e.uniform(new D(n.tileDimensions.width,n.tileDimensions.height)),d=e.uniform(Math.max(n.tileDimensions.width,n.tileDimensions.height)/256),L=e.Fn(([t])=>{const l=t.sub(s).div(u).add(.5);return e.clamp(l,0,1)}),v=e.Fn(([t])=>{const a=L(t);return o.uv(a).r.mul(r)}),b=e.Fn(([t])=>{const a=v(t.add(e.vec2(d.negate(),0))),l=v(t.add(e.vec2(d,0))),m=v(t.add(e.vec2(0,d.negate()))),x=v(t.add(e.vec2(0,d))),f=l.sub(a).div(d.mul(2)),T=x.sub(m).div(d.mul(2));return e.normalize(e.vec3(f.negate(),1,T.negate()))}),y=e.Fn(()=>{const t=e.positionLocal,a=e.modelWorldMatrix.mul(e.vec4(t,1)),l=e.vec2(a.x,a.z),m=v(l),x=t.y.lessThan(-.5),f=m.add(t.y),T=m,E=e.select(x,f,T);return e.vec3(t.x,E,t.z)})(),N=e.Fn(()=>{const t=e.positionLocal,a=e.modelWorldMatrix.mul(e.vec4(t,1)),l=e.vec2(a.x,a.z),m=b(l),x=t.y.lessThan(-.5);return e.select(x,e.normalLocal,m)})(),i=new c;i.positionNode=y,i.normalNode=N,i.roughness=.9,i.metalness=0,i.side=M;let p=null;return n.colorTexture&&(p=e.texture(n.colorTexture),i.colorNode=p),{material:i,setColorTexture:t=>{p=e.texture(t),i.colorNode=p,i.needsUpdate=!0}}}function Y(n,e){const c=new Uint16Array(n.length);for(let r=0;r<n.length;r++)c[r]=C(n[r]);const o=new P(c,e,e,S,g);return o.minFilter=U,o.magFilter=U,o.wrapS=_,o.wrapT=_,o.needsUpdate=!0,o}function C(n){const e=new Float32Array(1),c=new Int32Array(e.buffer);e[0]=n;const o=c[0],r=o>>31&1;let s=o>>23&255,u=o&8388607;return s===255?r<<15|31744|(u?512:0):s===0?r<<15:(s=s-127+15,s>=31?r<<15|31744:s<=0?r<<15:(u=u>>13,r<<15|s<<10|u))}export{Y as createElevationDataTextureWebGPU,R as createTSLTerrainMaterial};
//# sourceMappingURL=terrain-shader-tsl-Cr9UzDsZ.js.map
