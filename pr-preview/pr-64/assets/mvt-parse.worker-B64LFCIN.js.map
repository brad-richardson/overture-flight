{"version":3,"file":"mvt-parse.worker-B64LFCIN.js","sources":["../node_modules/@mapbox/point-geometry/index.js","../node_modules/@mapbox/vector-tile/index.js","../node_modules/pbf/index.js","../src/workers/mvt-parse.worker.ts"],"sourcesContent":["/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class\n * @param {number} x the x-coordinate. This could be longitude or screen pixels, or any other sort of unit.\n * @param {number} y the y-coordinate. This could be latitude or screen pixels, or any other sort of unit.\n *\n * @example\n * const point = new Point(-77, 38);\n */\nexport default function Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n    /**\n     * Clone this point, returning a new point that can be modified\n     * without affecting the old one.\n     * @return {Point} the clone\n     */\n    clone() { return new Point(this.x, this.y); },\n\n    /**\n     * Add this point's x & y coordinates to another point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    add(p) { return this.clone()._add(p); },\n\n    /**\n     * Subtract this point's x & y coordinates to from point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    sub(p) { return this.clone()._sub(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    multByPoint(p) { return this.clone()._multByPoint(p); },\n\n    /**\n     * Divide this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    divByPoint(p) { return this.clone()._divByPoint(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {number} k factor\n     * @return {Point} output point\n     */\n    mult(k) { return this.clone()._mult(k); },\n\n    /**\n     * Divide this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {number} k factor\n     * @return {Point} output point\n     */\n    div(k) { return this.clone()._div(k); },\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * @param {number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate(a) { return this.clone()._rotate(a); },\n\n    /**\n     * Rotate this point around p point by an angle a,\n     * given in radians\n     * @param {number} a angle to rotate around, in radians\n     * @param {Point} p Point to rotate around\n     * @return {Point} output point\n     */\n    rotateAround(a, p) { return this.clone()._rotateAround(a, p); },\n\n    /**\n     * Multiply this point by a 4x1 transformation matrix\n     * @param {[number, number, number, number]} m transformation matrix\n     * @return {Point} output point\n     */\n    matMult(m) { return this.clone()._matMult(m); },\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit() { return this.clone()._unit(); },\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp() { return this.clone()._perp(); },\n\n    /**\n     * Return a version of this point with the x & y coordinates\n     * rounded to integers.\n     * @return {Point} rounded point\n     */\n    round() { return this.clone()._round(); },\n\n    /**\n     * Return the magnitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {number} magnitude\n     */\n    mag() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    /**\n     * Judge whether this point is equal to another point, returning\n     * true or false.\n     * @param {Point} other the other point\n     * @return {boolean} whether the points are equal\n     */\n    equals(other) {\n        return this.x === other.x &&\n               this.y === other.y;\n    },\n\n    /**\n     * Calculate the distance from this point to another point\n     * @param {Point} p the other point\n     * @return {number} distance\n     */\n    dist(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    /**\n     * Calculate the distance from this point to another point,\n     * without the square root step. Useful if you're comparing\n     * relative distances.\n     * @param {Point} p the other point\n     * @return {number} distance\n     */\n    distSqr(p) {\n        const dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    /**\n     * Get the angle from the 0, 0 coordinate to this point, in radians\n     * coordinates.\n     * @return {number} angle\n     */\n    angle() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    /**\n     * Get the angle from this point to another point, in radians\n     * @param {Point} b the other point\n     * @return {number} angle\n     */\n    angleTo(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * @param {Point} b the other point\n     * @return {number} angle\n     */\n    angleWith(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    /**\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * @param {number} x the x-coordinate\n     * @param {number} y the y-coordinate\n     * @return {number} the angle in radians\n     */\n    angleWithSep(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    /** @param {[number, number, number, number]} m */\n    _matMult(m) {\n        const x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _add(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _sub(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    /** @param {number} k */\n    _mult(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    /** @param {number} k */\n    _div(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _multByPoint(p) {\n        this.x *= p.x;\n        this.y *= p.y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _divByPoint(p) {\n        this.x /= p.x;\n        this.y /= p.y;\n        return this;\n    },\n\n    _unit() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp() {\n        const y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    /** @param {number} angle */\n    _rotate(angle) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    /**\n     * @param {number} angle\n     * @param {Point} p\n     */\n    _rotateAround(angle, p) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n            y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    },\n\n    constructor: Point\n};\n\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, return it unchanged.\n * @param {Point | [number, number] | {x: number, y: number}} p input value\n * @return {Point} constructed point.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\nPoint.convert = function (p) {\n    if (p instanceof Point) {\n        return /** @type {Point} */ (p);\n    }\n    if (Array.isArray(p)) {\n        return new Point(+p[0], +p[1]);\n    }\n    if (p.x !== undefined && p.y !== undefined) {\n        return new Point(+p.x, +p.y);\n    }\n    throw new Error('Expected [x, y] or {x, y} point format');\n};\n","\nimport Point from '@mapbox/point-geometry';\n\n/** @import Pbf from 'pbf' */\n/** @import {Feature} from 'geojson' */\n\nexport class VectorTileFeature {\n    /**\n     * @param {Pbf} pbf\n     * @param {number} end\n     * @param {number} extent\n     * @param {string[]} keys\n     * @param {(number | string | boolean)[]} values\n     */\n    constructor(pbf, end, extent, keys, values) {\n        // Public\n\n        /** @type {Record<string, number | string | boolean>} */\n        this.properties = {};\n\n        this.extent = extent;\n        /** @type {0 | 1 | 2 | 3} */\n        this.type = 0;\n\n        /** @type {number | undefined} */\n        this.id = undefined;\n\n        /** @private */\n        this._pbf = pbf;\n        /** @private */\n        this._geometry = -1;\n        /** @private */\n        this._keys = keys;\n        /** @private */\n        this._values = values;\n\n        pbf.readFields(readFeature, this, end);\n    }\n\n    loadGeometry() {\n        const pbf = this._pbf;\n        pbf.pos = this._geometry;\n\n        const end = pbf.readVarint() + pbf.pos;\n\n        /** @type Point[][] */\n        const lines = [];\n\n        /** @type Point[] | undefined */\n        let line;\n\n        let cmd = 1;\n        let length = 0;\n        let x = 0;\n        let y = 0;\n\n        while (pbf.pos < end) {\n            if (length <= 0) {\n                const cmdLen = pbf.readVarint();\n                cmd = cmdLen & 0x7;\n                length = cmdLen >> 3;\n            }\n\n            length--;\n\n            if (cmd === 1 || cmd === 2) {\n                x += pbf.readSVarint();\n                y += pbf.readSVarint();\n\n                if (cmd === 1) { // moveTo\n                    if (line) lines.push(line);\n                    line = [];\n                }\n\n                if (line) line.push(new Point(x, y));\n\n            } else if (cmd === 7) {\n\n                // Workaround for https://github.com/mapbox/mapnik-vector-tile/issues/90\n                if (line) {\n                    line.push(line[0].clone()); // closePolygon\n                }\n\n            } else {\n                throw new Error(`unknown command ${cmd}`);\n            }\n        }\n\n        if (line) lines.push(line);\n\n        return lines;\n    }\n\n    bbox() {\n        const pbf = this._pbf;\n        pbf.pos = this._geometry;\n\n        const end = pbf.readVarint() + pbf.pos;\n        let cmd = 1,\n            length = 0,\n            x = 0,\n            y = 0,\n            x1 = Infinity,\n            x2 = -Infinity,\n            y1 = Infinity,\n            y2 = -Infinity;\n\n        while (pbf.pos < end) {\n            if (length <= 0) {\n                const cmdLen = pbf.readVarint();\n                cmd = cmdLen & 0x7;\n                length = cmdLen >> 3;\n            }\n\n            length--;\n\n            if (cmd === 1 || cmd === 2) {\n                x += pbf.readSVarint();\n                y += pbf.readSVarint();\n                if (x < x1) x1 = x;\n                if (x > x2) x2 = x;\n                if (y < y1) y1 = y;\n                if (y > y2) y2 = y;\n\n            } else if (cmd !== 7) {\n                throw new Error(`unknown command ${cmd}`);\n            }\n        }\n\n        return [x1, y1, x2, y2];\n    }\n\n    /**\n     * @param {number} x\n     * @param {number} y\n     * @param {number} z\n     * @return {Feature}\n     */\n    toGeoJSON(x, y, z) {\n        const size = this.extent * Math.pow(2, z),\n            x0 = this.extent * x,\n            y0 = this.extent * y,\n            vtCoords = this.loadGeometry();\n\n        /** @param {Point} p */\n        function projectPoint(p) {\n            return [\n                (p.x + x0) * 360 / size - 180,\n                360 / Math.PI * Math.atan(Math.exp((1 - (p.y + y0) * 2 / size) * Math.PI)) - 90\n            ];\n        }\n\n        /** @param {Point[]} line */\n        function projectLine(line) {\n            return line.map(projectPoint);\n        }\n\n        /** @type {Feature[\"geometry\"]} */\n        let geometry;\n\n        if (this.type === 1) {\n            const points = [];\n            for (const line of vtCoords) {\n                points.push(line[0]);\n            }\n            const coordinates = projectLine(points);\n            geometry = points.length === 1 ?\n                {type: 'Point', coordinates: coordinates[0]} :\n                {type: 'MultiPoint', coordinates};\n\n        } else if (this.type === 2) {\n\n            const coordinates = vtCoords.map(projectLine);\n            geometry = coordinates.length === 1 ?\n                {type: 'LineString', coordinates: coordinates[0]} :\n                {type: 'MultiLineString', coordinates};\n\n        } else if (this.type === 3) {\n            const polygons = classifyRings(vtCoords);\n            const coordinates = [];\n            for (const polygon of polygons) {\n                coordinates.push(polygon.map(projectLine));\n            }\n            geometry = coordinates.length === 1 ?\n                {type: 'Polygon', coordinates: coordinates[0]} :\n                {type: 'MultiPolygon', coordinates};\n        } else {\n\n            throw new Error('unknown feature type');\n        }\n\n        /** @type {Feature} */\n        const result = {\n            type: 'Feature',\n            geometry,\n            properties: this.properties\n        };\n\n        if (this.id != null) {\n            result.id = this.id;\n        }\n\n        return result;\n    }\n}\n\n/** @type {['Unknown', 'Point', 'LineString', 'Polygon']} */\nVectorTileFeature.types = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\n/**\n * @param {number} tag\n * @param {VectorTileFeature} feature\n * @param {Pbf} pbf\n */\nfunction readFeature(tag, feature, pbf) {\n    if (tag === 1) feature.id = pbf.readVarint();\n    else if (tag === 2) readTag(pbf, feature);\n    else if (tag === 3) feature.type = /** @type {0 | 1 | 2 | 3} */ (pbf.readVarint());\n    // @ts-expect-error TS2341 deliberately accessing a private property\n    else if (tag === 4) feature._geometry = pbf.pos;\n}\n\n/**\n * @param {Pbf} pbf\n * @param {VectorTileFeature} feature\n */\nfunction readTag(pbf, feature) {\n    const end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        // @ts-expect-error TS2341 deliberately accessing a private property\n        const key = feature._keys[pbf.readVarint()];\n        // @ts-expect-error TS2341 deliberately accessing a private property\n        const value = feature._values[pbf.readVarint()];\n        feature.properties[key] = value;\n    }\n}\n\n/** classifies an array of rings into polygons with outer rings and holes\n * @param {Point[][]} rings\n */\nexport function classifyRings(rings) {\n    const len = rings.length;\n\n    if (len <= 1) return [rings];\n\n    const polygons = [];\n    let polygon, ccw;\n\n    for (let i = 0; i < len; i++) {\n        const area = signedArea(rings[i]);\n        if (area === 0) continue;\n\n        if (ccw === undefined) ccw = area < 0;\n\n        if (ccw === area < 0) {\n            if (polygon) polygons.push(polygon);\n            polygon = [rings[i]];\n\n        } else if (polygon) {\n            polygon.push(rings[i]);\n        }\n    }\n    if (polygon) polygons.push(polygon);\n\n    return polygons;\n}\n\n/** @param {Point[]} ring */\nfunction signedArea(ring) {\n    let sum = 0;\n    for (let i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n}\n\nexport class VectorTileLayer {\n    /**\n     * @param {Pbf} pbf\n     * @param {number} [end]\n     */\n    constructor(pbf, end) {\n        // Public\n        this.version = 1;\n        this.name = '';\n        this.extent = 4096;\n        this.length = 0;\n\n        /** @private */\n        this._pbf = pbf;\n\n        /** @private\n         * @type {string[]} */\n        this._keys = [];\n\n        /** @private\n         * @type {(number | string | boolean)[]} */\n        this._values = [];\n\n        /** @private\n         * @type {number[]} */\n        this._features = [];\n\n        pbf.readFields(readLayer, this, end);\n\n        this.length = this._features.length;\n    }\n\n    /** return feature `i` from this layer as a `VectorTileFeature`\n     * @param {number} i\n     */\n    feature(i) {\n        if (i < 0 || i >= this._features.length) throw new Error('feature index out of bounds');\n\n        this._pbf.pos = this._features[i];\n\n        const end = this._pbf.readVarint() + this._pbf.pos;\n        return new VectorTileFeature(this._pbf, end, this.extent, this._keys, this._values);\n    }\n}\n\n/**\n * @param {number} tag\n * @param {VectorTileLayer} layer\n * @param {Pbf} pbf\n */\nfunction readLayer(tag, layer, pbf) {\n    if (tag === 15) layer.version = pbf.readVarint();\n    else if (tag === 1) layer.name = pbf.readString();\n    else if (tag === 5) layer.extent = pbf.readVarint();\n    // @ts-expect-error TS2341 deliberately accessing a private property\n    else if (tag === 2) layer._features.push(pbf.pos);\n    // @ts-expect-error TS2341 deliberately accessing a private property\n    else if (tag === 3) layer._keys.push(pbf.readString());\n    // @ts-expect-error TS2341 deliberately accessing a private property\n    else if (tag === 4) layer._values.push(readValueMessage(pbf));\n}\n\n/**\n * @param {Pbf} pbf\n */\nfunction readValueMessage(pbf) {\n    let value = null;\n    const end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        const tag = pbf.readVarint() >> 3;\n\n        value = tag === 1 ? pbf.readString() :\n            tag === 2 ? pbf.readFloat() :\n            tag === 3 ? pbf.readDouble() :\n            tag === 4 ? pbf.readVarint64() :\n            tag === 5 ? pbf.readVarint() :\n            tag === 6 ? pbf.readSVarint() :\n            tag === 7 ? pbf.readBoolean() : null;\n    }\n    if (value == null) {\n        throw new Error('unknown feature value');\n    }\n\n    return value;\n}\n\nexport class VectorTile {\n    /**\n     * @param {Pbf} pbf\n     * @param {number} [end]\n     */\n    constructor(pbf, end) {\n        /** @type {Record<string, VectorTileLayer>} */\n        this.layers = pbf.readFields(readTile, {}, end);\n    }\n}\n\n/**\n * @param {number} tag\n * @param {Record<string, VectorTileLayer>} layers\n * @param {Pbf} pbf\n */\nfunction readTile(tag, layers, pbf) {\n    if (tag === 3) {\n        const layer = new VectorTileLayer(pbf, pbf.readVarint() + pbf.pos);\n        if (layer.length) layers[layer.name] = layer;\n    }\n}\n","\nconst SHIFT_LEFT_32 = (1 << 16) * (1 << 16);\nconst SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n\n// Threshold chosen based on both benchmarking and knowledge about browser string\n// data structures (which currently switch structure types at 12 bytes or more)\nconst TEXT_DECODER_MIN_LENGTH = 12;\nconst utf8TextDecoder = typeof TextDecoder === 'undefined' ? null : new TextDecoder('utf-8');\n\nconst PBF_VARINT  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\nconst PBF_FIXED64 = 1; // 64-bit: double, fixed64, sfixed64\nconst PBF_BYTES   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\nconst PBF_FIXED32 = 5; // 32-bit: float, fixed32, sfixed32\n\nexport default class Pbf {\n    /**\n     * @param {Uint8Array | ArrayBuffer} [buf]\n     */\n    constructor(buf = new Uint8Array(16)) {\n        this.buf = ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf);\n        this.dataView = new DataView(this.buf.buffer);\n        this.pos = 0;\n        this.type = 0;\n        this.length = this.buf.length;\n    }\n\n    // === READING =================================================================\n\n    /**\n     * @template T\n     * @param {(tag: number, result: T, pbf: Pbf) => void} readField\n     * @param {T} result\n     * @param {number} [end]\n     */\n    readFields(readField, result, end = this.length) {\n        while (this.pos < end) {\n            const val = this.readVarint(),\n                tag = val >> 3,\n                startPos = this.pos;\n\n            this.type = val & 0x7;\n            readField(tag, result, this);\n\n            if (this.pos === startPos) this.skip(val);\n        }\n        return result;\n    }\n\n    /**\n     * @template T\n     * @param {(tag: number, result: T, pbf: Pbf) => void} readField\n     * @param {T} result\n     */\n    readMessage(readField, result) {\n        return this.readFields(readField, result, this.readVarint() + this.pos);\n    }\n\n    readFixed32() {\n        const val = this.dataView.getUint32(this.pos, true);\n        this.pos += 4;\n        return val;\n    }\n\n    readSFixed32() {\n        const val = this.dataView.getInt32(this.pos, true);\n        this.pos += 4;\n        return val;\n    }\n\n    // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n    readFixed64() {\n        const val = this.dataView.getUint32(this.pos, true) + this.dataView.getUint32(this.pos + 4, true) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    }\n\n    readSFixed64() {\n        const val = this.dataView.getUint32(this.pos, true) + this.dataView.getInt32(this.pos + 4, true) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    }\n\n    readFloat() {\n        const val = this.dataView.getFloat32(this.pos, true);\n        this.pos += 4;\n        return val;\n    }\n\n    readDouble() {\n        const val = this.dataView.getFloat64(this.pos, true);\n        this.pos += 8;\n        return val;\n    }\n\n    /**\n     * @param {boolean} [isSigned]\n     */\n    readVarint(isSigned) {\n        const buf = this.buf;\n        let val, b;\n\n        b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n        b = buf[this.pos];   val |= (b & 0x0f) << 28;\n\n        return readVarintRemainder(val, isSigned, this);\n    }\n\n    readVarint64() { // for compatibility with v2.0.1\n        return this.readVarint(true);\n    }\n\n    readSVarint() {\n        const num = this.readVarint();\n        return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n    }\n\n    readBoolean() {\n        return Boolean(this.readVarint());\n    }\n\n    readString() {\n        const end = this.readVarint() + this.pos;\n        const pos = this.pos;\n        this.pos = end;\n\n        if (end - pos >= TEXT_DECODER_MIN_LENGTH && utf8TextDecoder) {\n            // longer strings are fast with the built-in browser TextDecoder API\n            return utf8TextDecoder.decode(this.buf.subarray(pos, end));\n        }\n        // short strings are fast with our custom implementation\n        return readUtf8(this.buf, pos, end);\n    }\n\n    readBytes() {\n        const end = this.readVarint() + this.pos,\n            buffer = this.buf.subarray(this.pos, end);\n        this.pos = end;\n        return buffer;\n    }\n\n    // verbose for performance reasons; doesn't affect gzipped size\n\n    /**\n     * @param {number[]} [arr]\n     * @param {boolean} [isSigned]\n     */\n    readPackedVarint(arr = [], isSigned) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readVarint(isSigned));\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedSVarint(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readSVarint());\n        return arr;\n    }\n    /** @param {boolean[]} [arr] */\n    readPackedBoolean(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readBoolean());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedFloat(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readFloat());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedDouble(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readDouble());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedFixed32(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readFixed32());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedSFixed32(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readSFixed32());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedFixed64(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readFixed64());\n        return arr;\n    }\n    /** @param {number[]} [arr] */\n    readPackedSFixed64(arr = []) {\n        const end = this.readPackedEnd();\n        while (this.pos < end) arr.push(this.readSFixed64());\n        return arr;\n    }\n    readPackedEnd() {\n        return this.type === PBF_BYTES ? this.readVarint() + this.pos : this.pos + 1;\n    }\n\n    /** @param {number} val */\n    skip(val) {\n        const type = val & 0x7;\n        if (type === PBF_VARINT) while (this.buf[this.pos++] > 0x7f) {}\n        else if (type === PBF_BYTES) this.pos = this.readVarint() + this.pos;\n        else if (type === PBF_FIXED32) this.pos += 4;\n        else if (type === PBF_FIXED64) this.pos += 8;\n        else throw new Error(`Unimplemented type: ${type}`);\n    }\n\n    // === WRITING =================================================================\n\n    /**\n     * @param {number} tag\n     * @param {number} type\n     */\n    writeTag(tag, type) {\n        this.writeVarint((tag << 3) | type);\n    }\n\n    /** @param {number} min */\n    realloc(min) {\n        let length = this.length || 16;\n\n        while (length < this.pos + min) length *= 2;\n\n        if (length !== this.length) {\n            const buf = new Uint8Array(length);\n            buf.set(this.buf);\n            this.buf = buf;\n            this.dataView = new DataView(buf.buffer);\n            this.length = length;\n        }\n    }\n\n    finish() {\n        this.length = this.pos;\n        this.pos = 0;\n        return this.buf.subarray(0, this.length);\n    }\n\n    /** @param {number} val */\n    writeFixed32(val) {\n        this.realloc(4);\n        this.dataView.setInt32(this.pos, val, true);\n        this.pos += 4;\n    }\n\n    /** @param {number} val */\n    writeSFixed32(val) {\n        this.realloc(4);\n        this.dataView.setInt32(this.pos, val, true);\n        this.pos += 4;\n    }\n\n    /** @param {number} val */\n    writeFixed64(val) {\n        this.realloc(8);\n        this.dataView.setInt32(this.pos, val & -1, true);\n        this.dataView.setInt32(this.pos + 4, Math.floor(val * SHIFT_RIGHT_32), true);\n        this.pos += 8;\n    }\n\n    /** @param {number} val */\n    writeSFixed64(val) {\n        this.realloc(8);\n        this.dataView.setInt32(this.pos, val & -1, true);\n        this.dataView.setInt32(this.pos + 4, Math.floor(val * SHIFT_RIGHT_32), true);\n        this.pos += 8;\n    }\n\n    /** @param {number} val */\n    writeVarint(val) {\n        val = +val || 0;\n\n        if (val > 0xfffffff || val < 0) {\n            writeBigVarint(val, this);\n            return;\n        }\n\n        this.realloc(4);\n\n        this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n    }\n\n    /** @param {number} val */\n    writeSVarint(val) {\n        this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n    }\n\n    /** @param {boolean} val */\n    writeBoolean(val) {\n        this.writeVarint(+val);\n    }\n\n    /** @param {string} str */\n    writeString(str) {\n        str = String(str);\n        this.realloc(str.length * 4);\n\n        this.pos++; // reserve 1 byte for short string length\n\n        const startPos = this.pos;\n        // write the string directly to the buffer and see how much was written\n        this.pos = writeUtf8(this.buf, str, this.pos);\n        const len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    }\n\n    /** @param {number} val */\n    writeFloat(val) {\n        this.realloc(4);\n        this.dataView.setFloat32(this.pos, val, true);\n        this.pos += 4;\n    }\n\n    /** @param {number} val */\n    writeDouble(val) {\n        this.realloc(8);\n        this.dataView.setFloat64(this.pos, val, true);\n        this.pos += 8;\n    }\n\n    /** @param {Uint8Array} buffer */\n    writeBytes(buffer) {\n        const len = buffer.length;\n        this.writeVarint(len);\n        this.realloc(len);\n        for (let i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n    }\n\n    /**\n     * @template T\n     * @param {(obj: T, pbf: Pbf) => void} fn\n     * @param {T} obj\n     */\n    writeRawMessage(fn, obj) {\n        this.pos++; // reserve 1 byte for short message length\n\n        // write the message directly to the buffer and see how much was written\n        const startPos = this.pos;\n        fn(obj, this);\n        const len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    }\n\n    /**\n     * @template T\n     * @param {number} tag\n     * @param {(obj: T, pbf: Pbf) => void} fn\n     * @param {T} obj\n     */\n    writeMessage(tag, fn, obj) {\n        this.writeTag(tag, PBF_BYTES);\n        this.writeRawMessage(fn, obj);\n    }\n\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedVarint(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedVarint, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedSVarint(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedSVarint, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {boolean[]} arr\n     */\n    writePackedBoolean(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedBoolean, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedFloat(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedFloat, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedDouble(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedDouble, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedFixed32(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedFixed32, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedSFixed32(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedSFixed32, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedFixed64(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedFixed64, arr);\n    }\n    /**\n     * @param {number} tag\n     * @param {number[]} arr\n     */\n    writePackedSFixed64(tag, arr) {\n        if (arr.length) this.writeMessage(tag, writePackedSFixed64, arr);\n    }\n\n    /**\n     * @param {number} tag\n     * @param {Uint8Array} buffer\n     */\n    writeBytesField(tag, buffer) {\n        this.writeTag(tag, PBF_BYTES);\n        this.writeBytes(buffer);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeFixed32Field(tag, val) {\n        this.writeTag(tag, PBF_FIXED32);\n        this.writeFixed32(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeSFixed32Field(tag, val) {\n        this.writeTag(tag, PBF_FIXED32);\n        this.writeSFixed32(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeFixed64Field(tag, val) {\n        this.writeTag(tag, PBF_FIXED64);\n        this.writeFixed64(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeSFixed64Field(tag, val) {\n        this.writeTag(tag, PBF_FIXED64);\n        this.writeSFixed64(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeVarintField(tag, val) {\n        this.writeTag(tag, PBF_VARINT);\n        this.writeVarint(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeSVarintField(tag, val) {\n        this.writeTag(tag, PBF_VARINT);\n        this.writeSVarint(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {string} str\n     */\n    writeStringField(tag, str) {\n        this.writeTag(tag, PBF_BYTES);\n        this.writeString(str);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeFloatField(tag, val) {\n        this.writeTag(tag, PBF_FIXED32);\n        this.writeFloat(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {number} val\n     */\n    writeDoubleField(tag, val) {\n        this.writeTag(tag, PBF_FIXED64);\n        this.writeDouble(val);\n    }\n    /**\n     * @param {number} tag\n     * @param {boolean} val\n     */\n    writeBooleanField(tag, val) {\n        this.writeVarintField(tag, +val);\n    }\n};\n\n/**\n * @param {number} l\n * @param {boolean | undefined} s\n * @param {Pbf} p\n */\nfunction readVarintRemainder(l, s, p) {\n    const buf = p.buf;\n    let h, b;\n\n    b = buf[p.pos++]; h  = (b & 0x70) >> 4;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 3;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 10; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 17; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 24; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x01) << 31; if (b < 0x80) return toNum(l, h, s);\n\n    throw new Error('Expected varint not more than 10 bytes');\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {boolean} [isSigned]\n */\nfunction toNum(low, high, isSigned) {\n    return isSigned ? high * 0x100000000 + (low >>> 0) : ((high >>> 0) * 0x100000000) + (low >>> 0);\n}\n\n/**\n * @param {number} val\n * @param {Pbf} pbf\n */\nfunction writeBigVarint(val, pbf) {\n    let low, high;\n\n    if (val >= 0) {\n        low  = (val % 0x100000000) | 0;\n        high = (val / 0x100000000) | 0;\n    } else {\n        low  = ~(-val % 0x100000000);\n        high = ~(-val / 0x100000000);\n\n        if (low ^ 0xffffffff) {\n            low = (low + 1) | 0;\n        } else {\n            low = 0;\n            high = (high + 1) | 0;\n        }\n    }\n\n    if (val >= 0x10000000000000000 || val < -0x10000000000000000) {\n        throw new Error('Given varint doesn\\'t fit into 10 bytes');\n    }\n\n    pbf.realloc(10);\n\n    writeBigVarintLow(low, high, pbf);\n    writeBigVarintHigh(high, pbf);\n}\n\n/**\n * @param {number} high\n * @param {number} low\n * @param {Pbf} pbf\n */\nfunction writeBigVarintLow(low, high, pbf) {\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos]   = low & 0x7f;\n}\n\n/**\n * @param {number} high\n * @param {Pbf} pbf\n */\nfunction writeBigVarintHigh(high, pbf) {\n    const lsb = (high & 0x07) << 4;\n\n    pbf.buf[pbf.pos++] |= lsb         | ((high >>>= 3) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f;\n}\n\n/**\n * @param {number} startPos\n * @param {number} len\n * @param {Pbf} pbf\n */\nfunction makeRoomForExtraLength(startPos, len, pbf) {\n    const extraLen =\n        len <= 0x3fff ? 1 :\n        len <= 0x1fffff ? 2 :\n        len <= 0xfffffff ? 3 : Math.floor(Math.log(len) / (Math.LN2 * 7));\n\n    // if 1 byte isn't enough for encoding message length, shift the data to the right\n    pbf.realloc(extraLen);\n    for (let i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n}\n\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedVarint(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedSVarint(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedFloat(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedDouble(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);\n}\n/**\n * @param {boolean[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedBoolean(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedFixed32(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedSFixed32(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedFixed64(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);\n}\n/**\n * @param {number[]} arr\n * @param {Pbf} pbf\n */\nfunction writePackedSFixed64(arr, pbf) {\n    for (let i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]);\n}\n\n// Buffer code below from https://github.com/feross/buffer, MIT-licensed\n\n/**\n * @param {Uint8Array} buf\n * @param {number} pos\n * @param {number} end\n */\nfunction readUtf8(buf, pos, end) {\n    let str = '';\n    let i = pos;\n\n    while (i < end) {\n        const b0 = buf[i];\n        let c = null; // codepoint\n        let bytesPerSequence =\n            b0 > 0xEF ? 4 :\n            b0 > 0xDF ? 3 :\n            b0 > 0xBF ? 2 : 1;\n\n        if (i + bytesPerSequence > end) break;\n\n        let b1, b2, b3;\n\n        if (bytesPerSequence === 1) {\n            if (b0 < 0x80) {\n                c = b0;\n            }\n        } else if (bytesPerSequence === 2) {\n            b1 = buf[i + 1];\n            if ((b1 & 0xC0) === 0x80) {\n                c = (b0 & 0x1F) << 0x6 | (b1 & 0x3F);\n                if (c <= 0x7F) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 3) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0xC | (b1 & 0x3F) << 0x6 | (b2 & 0x3F);\n                if (c <= 0x7FF || (c >= 0xD800 && c <= 0xDFFF)) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 4) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            b3 = buf[i + 3];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0x12 | (b1 & 0x3F) << 0xC | (b2 & 0x3F) << 0x6 | (b3 & 0x3F);\n                if (c <= 0xFFFF || c >= 0x110000) {\n                    c = null;\n                }\n            }\n        }\n\n        if (c === null) {\n            c = 0xFFFD;\n            bytesPerSequence = 1;\n\n        } else if (c > 0xFFFF) {\n            c -= 0x10000;\n            str += String.fromCharCode(c >>> 10 & 0x3FF | 0xD800);\n            c = 0xDC00 | c & 0x3FF;\n        }\n\n        str += String.fromCharCode(c);\n        i += bytesPerSequence;\n    }\n\n    return str;\n}\n\n/**\n * @param {Uint8Array} buf\n * @param {string} str\n * @param {number} pos\n */\nfunction writeUtf8(buf, str, pos) {\n    for (let i = 0, c, lead; i < str.length; i++) {\n        c = str.charCodeAt(i); // code point\n\n        if (c > 0xD7FF && c < 0xE000) {\n            if (lead) {\n                if (c < 0xDC00) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                    lead = c;\n                    continue;\n                } else {\n                    c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                    lead = null;\n                }\n            } else {\n                if (c > 0xDBFF || (i + 1 === str.length)) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                } else {\n                    lead = c;\n                }\n                continue;\n            }\n        } else if (lead) {\n            buf[pos++] = 0xEF;\n            buf[pos++] = 0xBF;\n            buf[pos++] = 0xBD;\n            lead = null;\n        }\n\n        if (c < 0x80) {\n            buf[pos++] = c;\n        } else {\n            if (c < 0x800) {\n                buf[pos++] = c >> 0x6 | 0xC0;\n            } else {\n                if (c < 0x10000) {\n                    buf[pos++] = c >> 0xC | 0xE0;\n                } else {\n                    buf[pos++] = c >> 0x12 | 0xF0;\n                    buf[pos++] = c >> 0xC & 0x3F | 0x80;\n                }\n                buf[pos++] = c >> 0x6 & 0x3F | 0x80;\n            }\n            buf[pos++] = c & 0x3F | 0x80;\n        }\n    }\n    return pos;\n}\n","/**\n * Web Worker for MVT parsing\n * Offloads CPU-intensive MVT decoding from the main thread\n * Uses transferable typed arrays for efficient data transfer\n */\n\nimport { VectorTile } from '@mapbox/vector-tile';\nimport Pbf from 'pbf';\nimport type { WorkerRequest, WorkerResponse, CompactFeature, ParseMVTResult } from './types.js';\n\n// Geometry type mapping\nconst GEOM_TYPE_MAP: Record<string, number> = {\n  'Point': 0,\n  'MultiPoint': 1,\n  'LineString': 2,\n  'MultiLineString': 3,\n  'Polygon': 4,\n  'MultiPolygon': 5,\n};\n\n/**\n * Flatten nested coordinate arrays to Float64Array\n * Returns coordinates and ring indices for reconstruction\n */\nfunction flattenCoordinates(\n  geomType: string,\n  coordinates: number[] | number[][] | number[][][] | number[][][][]\n): { coords: Float64Array; ringIndices: Uint32Array } {\n  const flatCoords: number[] = [];\n  const ringStarts: number[] = [];\n\n  function processRing(ring: number[][]) {\n    ringStarts.push(flatCoords.length / 2);\n    for (const coord of ring) {\n      flatCoords.push(coord[0], coord[1]);\n    }\n  }\n\n  function processPolygon(polygon: number[][][]) {\n    for (const ring of polygon) {\n      processRing(ring);\n    }\n  }\n\n  switch (geomType) {\n    case 'Point':\n      flatCoords.push((coordinates as number[])[0], (coordinates as number[])[1]);\n      break;\n\n    case 'MultiPoint':\n    case 'LineString':\n      for (const coord of coordinates as number[][]) {\n        flatCoords.push(coord[0], coord[1]);\n      }\n      break;\n\n    case 'MultiLineString':\n      for (const line of coordinates as number[][][]) {\n        ringStarts.push(flatCoords.length / 2);\n        for (const coord of line) {\n          flatCoords.push(coord[0], coord[1]);\n        }\n      }\n      break;\n\n    case 'Polygon':\n      processPolygon(coordinates as number[][][]);\n      break;\n\n    case 'MultiPolygon':\n      for (const polygon of coordinates as number[][][][]) {\n        processPolygon(polygon);\n      }\n      break;\n  }\n\n  return {\n    coords: new Float64Array(flatCoords),\n    ringIndices: new Uint32Array(ringStarts),\n  };\n}\n\n/**\n * Extract only commonly used properties to minimize transfer size\n * Includes all properties used in tile-texture-renderer.ts for styling\n */\nfunction extractProperties(props: Record<string, unknown>): CompactFeature['props'] {\n  const result: CompactFeature['props'] = {};\n\n  // Properties used in rendering/filtering/styling\n  if (props.subtype !== undefined) result.subtype = props.subtype as string;\n  if (props.class !== undefined) result.class = props.class as string;\n  if (props.surface !== undefined) result.surface = props.surface as string;\n  if (props.road_flags !== undefined) result.road_flags = props.road_flags as string;\n  if (props.level_rules !== undefined) result.level_rules = props.level_rules as string;\n  if (props.level !== undefined) result.level = props.level as number;\n  if (props._fromLowerZoom !== undefined) result._fromLowerZoom = props._fromLowerZoom as boolean;\n  if (props._sourceZoom !== undefined) result._sourceZoom = props._sourceZoom as number;\n\n  // Additional properties for styling (tile-texture-renderer.ts)\n  if (props.type !== undefined) result.type = props.type as string;\n  if (props.category !== undefined) result.category = props.category as string;\n  if (props.depth !== undefined) result.depth = props.depth as number;\n  if (props.road_class !== undefined) result.road_class = props.road_class as string;\n  if (props.highway !== undefined) result.highway = props.highway as string;\n  if (props.is_tunnel !== undefined) result.is_tunnel = props.is_tunnel as boolean;\n  if (props.is_underground !== undefined) result.is_underground = props.is_underground as boolean;\n\n  // Handle names object\n  if (props.names && typeof props.names === 'object') {\n    const names = props.names as Record<string, unknown>;\n    if (names.primary) {\n      result.names = { primary: names.primary as string };\n    }\n  }\n\n  return result;\n}\n\n/**\n * Parse MVT data and return compact features\n */\nfunction parseMVT(\n  data: ArrayBuffer,\n  tileX: number,\n  tileY: number,\n  zoom: number,\n  layerName: string | null\n): ParseMVTResult {\n  const tile = new VectorTile(new Pbf(data));\n  const features: CompactFeature[] = [];\n  const layerCounts: Record<string, number> = {};\n\n  const allLayerNames = Object.keys(tile.layers);\n  const layerNames = layerName && tile.layers[layerName] ? [layerName] : allLayerNames;\n\n  for (const name of layerNames) {\n    const layer = tile.layers[name];\n    if (!layer) continue;\n\n    layerCounts[name] = layer.length;\n\n    for (let i = 0; i < layer.length; i++) {\n      const feature = layer.feature(i);\n      const geojson = feature.toGeoJSON(tileX, tileY, zoom);\n      const geomType = geojson.geometry.type;\n\n      // Flatten coordinates to typed arrays\n      const { coords, ringIndices } = flattenCoordinates(\n        geomType,\n        geojson.geometry.coordinates\n      );\n\n      features.push({\n        typeIndex: GEOM_TYPE_MAP[geomType] ?? -1,\n        layer: name,\n        coords,\n        ringIndices,\n        props: extractProperties(feature.properties as Record<string, unknown>),\n      });\n    }\n  }\n\n  return { features, layerCounts };\n}\n\n/**\n * Get transferable buffers from result\n */\nfunction getTransferables(result: ParseMVTResult): ArrayBuffer[] {\n  const buffers: ArrayBuffer[] = [];\n  for (const feature of result.features) {\n    if (feature.coords.buffer instanceof ArrayBuffer) {\n      buffers.push(feature.coords.buffer);\n    }\n    if (feature.ringIndices.buffer instanceof ArrayBuffer) {\n      buffers.push(feature.ringIndices.buffer);\n    }\n  }\n  return buffers;\n}\n\n/**\n * Handle incoming messages from the main thread\n */\nself.onmessage = (event: MessageEvent<WorkerRequest>) => {\n  const request = event.data;\n\n  try {\n    switch (request.type) {\n      case 'CAPABILITY_CHECK': {\n        const response: WorkerResponse = {\n          type: 'CAPABILITY_CHECK_RESULT',\n          id: request.id,\n          supported: true,\n        };\n        self.postMessage(response);\n        break;\n      }\n\n      case 'PARSE_MVT': {\n        const { data, tileX, tileY, zoom, layerName } = request.payload;\n\n        // Parse MVT\n        const result = parseMVT(data, tileX, tileY, zoom, layerName);\n\n        // Get transferable buffers for zero-copy transfer\n        const transferables = getTransferables(result);\n\n        const response: WorkerResponse = {\n          type: 'PARSE_MVT_RESULT',\n          id: request.id,\n          result,\n        };\n\n        // Transfer ownership of buffers (zero-copy)\n        self.postMessage(response, { transfer: transferables });\n        break;\n      }\n\n      default: {\n        const response: WorkerResponse = {\n          type: 'ERROR',\n          id: (request as { id?: string }).id || 'unknown',\n          error: `MVT worker received unsupported request type: ${(request as { type?: string }).type}`,\n        };\n        self.postMessage(response);\n      }\n    }\n  } catch (error) {\n    const response: WorkerResponse = {\n      type: 'ERROR',\n      id: request.id,\n      error: error instanceof Error ? error.message : 'Unknown error in MVT worker',\n    };\n    self.postMessage(response);\n  }\n};\n\n// Signal that worker is ready\nself.postMessage({ type: 'READY' });\n"],"names":["Point","x","y","p","k","a","m","other","dx","dy","b","angle","cos","sin","VectorTileFeature","pbf","end","extent","keys","values","readFeature","lines","line","cmd","length","cmdLen","x1","x2","y1","y2","z","size","x0","y0","vtCoords","projectPoint","projectLine","geometry","points","coordinates","polygons","classifyRings","polygon","result","tag","feature","readTag","key","value","rings","len","ccw","i","area","signedArea","ring","sum","j","p1","p2","VectorTileLayer","readLayer","layer","readValueMessage","VectorTile","readTile","layers","SHIFT_LEFT_32","SHIFT_RIGHT_32","TEXT_DECODER_MIN_LENGTH","utf8TextDecoder","PBF_VARINT","PBF_FIXED64","PBF_BYTES","PBF_FIXED32","Pbf","buf","readField","val","startPos","isSigned","readVarintRemainder","num","pos","readUtf8","buffer","arr","type","min","writeBigVarint","str","writeUtf8","makeRoomForExtraLength","fn","obj","writePackedVarint","writePackedSVarint","writePackedBoolean","writePackedFloat","writePackedDouble","writePackedFixed32","writePackedSFixed32","writePackedFixed64","writePackedSFixed64","l","s","h","toNum","low","high","writeBigVarintLow","writeBigVarintHigh","lsb","extraLen","b0","c","bytesPerSequence","b1","b2","b3","lead","GEOM_TYPE_MAP","flattenCoordinates","geomType","flatCoords","ringStarts","processRing","coord","processPolygon","extractProperties","props","names","parseMVT","data","tileX","tileY","zoom","layerName","tile","features","layerCounts","allLayerNames","layerNames","name","geojson","coords","ringIndices","getTransferables","buffers","event","request","response","transferables","error"],"mappings":"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","x_google_ignoreList":[0,1,2]}